In the isAuthenticated function use token as signature i.e. is the token present and is the token matching to the user trying to access his individual user information - get the user not by getting the user value from the frontend but by getting the user value associated with the token - this means it has to be a token for the user
https://cdn.shopify.com/shopifycloud/shopify_dev/assets/partners/jwt-request-flow-8377bd9698797d2d23713676585a01f9da42c80596ebdc673b971a1e577c65d4.png